---
title: "EDA of Spanish electricity generation 2015-2018"
subtitle: 'Group 16: Time Series - Assignment 3 - EDA Report'
output:
  html_document:
    toc: yes
    toc_depth: 2
    fig_caption: yes
  pdf_document:
    latex_engine: xelatex
    toc: no
    toc_depth: '2'
bibliography: references.bib 
csl: annals-of-data-science.csl
link-citations: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, fig.align = 'center')
```

```{r libraries, echo=FALSE, message=FALSE, warning=FALSE}
# Load libraries
library(tidyverse)
library(magrittr)
library(lubridate)
library(imputeTS)
library(modelsummary)
library(corrplot)
library(plotly)
library(timetk)
library(seastests)
library(ggfortify)
library(zoo)
library(tseries)
library(astsa)
library(BBmisc)
library(forecast)
library(ggplot2)
```

```{r data, echo=FALSE, message=FALSE, warning=FALSE}
df <- read.csv("../data/energy_dataset.csv")

# Change to datetime var
df$time <- as_datetime(df$time, tz="CET")

# Removing variables with no values
unimputed_data <- df %>%
  select(-c(generation.fossil.coal.derived.gas,
                    generation.fossil.oil.shale,
                    generation.fossil.peat,
                    generation.geothermal,
                    generation.marine,
                    generation.hydro.pumped.storage.aggregated,
                    generation.wind.offshore,
                    forecast.wind.offshore.eday.ahead)) 

# Removing outliers
outlier_rows <- unimputed_data[unimputed_data$time %in% ymd_hms('2017-11-12 20:00:00', '2017-11-14 11:00:00', '2017-11-14 18:00:00'),]

outlier_rows[outlier_rows == 0] <- NA

unimputed_data_cleaner <- unimputed_data

unimputed_data_cleaner[unimputed_data_cleaner$time %in% ymd_hms('2017-11-12 20:00:00', '2017-11-14 11:00:00', '2017-11-14 18:00:00'),] <- outlier_rows

# Interpolating missing values
data <- unimputed_data_cleaner %>% 
          mutate(across(generation.biomass:price.actual, .fns = na_interpolation, option = 'linear')) %>% 
          select(c(1, starts_with("generation")))

# Giving vars simpler names
names(data) <- c("time",
                 "Biomass",
                 "Lignite",
                 "Gas",
                 "Hard Coal",
                 "Oil",
                 "Hydro Pumped",
                 "Hydro River",
                 "Hydro Reservoir",
                 "Nuclear",
                 "Other",
                 "Other Renewable",
                 "Solar",
                 "Waste",
                 "Wind Onshore")
        

data_long <- data %>% pivot_longer(cols = -time, names_to = "generation_source")
```

Daniel Petterson (300467629), Rob Tomkies (300588353), and Daniel Wrench (300398222)

**Due 5pm Tuesday 31st August**

This report is accompanied by an [online dashboard](https://danielpetterson.shinyapps.io/scripts/), developed in R Shiny. The app allows interactive visualisation and comparison of each time series, and is discussed in greater detail in the section [Time series visualisation].

# Background and Data

*1-3 pages, 6 marks*

We chose to study a time series dataset about electricity generation in Spain over a four-year period. This data originally comes from the "ENTSO-E Transparency Platform" dashboard[@entso]. ENTSO stands for *European Network of Transmission System Operators for Electricity*, and this website is the central collection and visualisation repository of electricity generation, transportation and consumption data across Europe. European Member States are required to submit this data to this platform. The data for Spain from the start of 2015 to the end of 2018 was collected from the dashboard and published on the data repository website Kaggle[@kaggledata].

The raw dataset from Kaggle contained variables for electricity consumption, generation, and pricing, recorded every hour of the four years, as well as day-ahead forecasts. For this exploration of the data, we limited our investigation to hourly electricity generation, which is divided into several different generation sources/methods.

In 2009 Spain became subject to EU Directive 2009/28/EC which mandates an EU-wide commitment to expanding the use of renewable energy [@eudir]. The target was for 20% of all energy consumed in the bloc to be generated by renewable sources by 2020.The Spanish government subsequently published the Plan de Energias Renovables 2011-2020 outlining how it planned to meet its commitments[@plandeenergias].

The question we formulated to guide our EDA is as follows:

**How does the amount of electricity generated by different sources change over time, individually and with respect to other sources?**

This question is worth investigating due to the pressing global challenge of climate change, and the consequent need for countries to transition to a sustainable energy economy. In order for this to be possible, we need to understand how electricity is currently being generated and what the long-term trends are, to see whether a nation's energy policy should continue or diverge from the current trajectory. Furthermore, governments need to know how electricity generation sources vary seasonally and what interdependencies there are.


After removing the variables that were not relevant to our analysis, and those that contained no observations, the dataset contained hourly recordings of the amount of power generated from 14 different sources (solar, nuclear, etc.) in Spain between 2015 and 2019. This equates to about 35,000 observations for each source. 

As well as some missing values (discussed further below), we discovered some outliers in the data. Interestingly, these occurred across variables at the exact same timestamps. We identified 3 rows in the raw dataset in which all but one generation source recorded a value of 0. This is shown by the three negative spikes in the plot below:

<center>
![](../figures/strange_zeros.png){width=80%}
</center>

Because they seem very unlikely to be true values, these outliers were removed. *We also identified two other rows where values were a significant departure from the typical range of that source, but were not equal to zero. These have not been removed because they could be plausible values (**confirm whether we are OK with this, otherwise I (Dan W) am happy to remove these too**)*

After removing the outliers, each variable had between 18 and 22 missing values. Most of these missing values occurred across variables: there were 21 rows for which data for all or all but one variables were missing, and five rows in where only one variable was missing. In most cases, we were confident in imputing the missing values using linear interpolation. However, there was one area of slight concern: of the 26 rows with missing data, six of them are consecutive. The plots below show how this imputation affected two of the variables.

```{r interpolation plot 1}
# Creating interpolation indicator vars
data$interp_gas <- as.integer(is.na(unimputed_data$generation.fossil.gas))
data$interp_solar <- as.integer(is.na(unimputed_data$generation.solar))

# Note that using geom_point is strictly more accurate
ggplot(data[50:150,]) + geom_point(aes(x= time, y = Solar, colour = interp_solar), show.legend = FALSE) + scale_color_gradient(low="black", high="red") + labs(x = '', title = "Solar variable post-linear interpolation")
```

The linear interpolation over the adjacent missing values in the Solar variable did not follow the strong seasonal pattern observed for this variable.

```{r interpolation plot 2}
ggplot(data[50:150,]) + geom_point(aes(x= time, y = `Gas`, colour = interp_solar), show.legend = FALSE) + scale_color_gradient(low="black", high="red") + labs(x = '', title = "Gas variable post-linear interpolation")

# Removing indicator vars
data <- data %>% select(-c(interp_gas, interp_solar))
```

The linear interpolation over the adjacent missing values in the Gas variable looks as if it may also result in some distortion of the fluctuation in this variable, but it is less obvious than for Solar.

Overall, despite linear interpolation not following the trend of the data for some variables, this gap represents a very small proportion of each time series (less than 0.02% of the series), so we were content to make this small distortion of the data and apply the interpolation method consistently across each variable.

# Ethics, Privacy, and Security

## Ethics

While there is no intention to utilise this study for any purpose beyond academic, the ethical concerns relating to this project entirely come from possible uses and interpretations of the outputs of this study in the real world. Primarily, these would relate to political decisions of national energy policy and investment. Spain has an established nuclear sector which has had opposition since the 1950s when the government initially announced its intentions to develop the capability[@antinuke]. The arguments against nuclear largely focus on the hazardous waste, potential consequences of disaster, and association with weapons of mass destruction. If this paper were utilized to argue for further development of Spain's nuclear power industry, these concerns must be considered. Similarly, as mentioned in [Background and Data], there are growing concerns around hydrocarbon-based fuel sources and their impact on climate and air quality. This study specifically makes no recommendations, but if people decide to develop hydrocarbon-based energy sources they should consider the ethics of their impact on the environment. Therefore, global warming is both a political and, in some ways, an ethical issue, and so this would also need to be considered if information from this study were used to support any decisions made about this global challenge.

There are ethical issues to consider beyond technology and climate change as well, in terms of the effect of energy sector policy on people. Any modelling completed from this data is at a national level, and one must remember this does not mean there is equal access to energy amongst the population from each source. For example, if the government decided to shift to a non-diversified energy model, or banned local diesel generators, it is possible that certain areas, most likely rural, would have less access to electricity, having an adverse effect on the people who live in these areas. A more likely scenario is one in which, due to political pressure, the government chooses to invest in a more expensive source of energy in order to achieve a higher proportion of green energy [@powerplay]. Pushing power prices up would disproportionately affect people from a lower socioeconomic background, which could lead to greater poverty and a greater class divide in the country. This problem could be exacerbated if such investment comes with more automation, leading to greater efficiency at the cost of lower skilled jobs and again disproportionately affecting the lower socioeconomic class.

There is a small risk of creating feedback cycles relating to the above concerns. This would only occur if decisions made based on the results of this study created a negative affect as discussed above, which was then integrated into another model which the further exacerbated the issue in turn. As this study is a non-reactive one off and there is no intention to base decision making upon the models of this exercise, the concern of feedback loops has been considered outside the remit of the ethical concerns of this study.

Spain has many formally recognized ethnicities and minorities[@minority] however the Spanish Personal Data Protection Act No. 15/1999 does not extend any explicit protection for or guidance on the use and storage of data from these groups. This means that handling approaches and considerations like the protective measures and regulations offered to people such as the Māori in New Zealand are not present or relevant in Spanish law[@datacollection]. Furthermore, because this data is recorded and stored at a national level from generation source, there is little about personal ethics and the use of personal data that is relevant or of concern to this study. There are no religious concerns with energy modelling beyond those discussed to do with environmental and social impacts.

## Privacy

Privacy relates to your right not to be asked invasive questions or to needlessly provide personal information, as well as the assurance that any publications made from the data cannot be used to identify you. The data from this study was collected at source of generation and then generalized to a national resolution. This means that there has never been any personal information stored within the data and would only be a concern if the data was compiled as the sum of individuals' energy use. A possible concern could arise if the data was collected from relatively small areas, such as suburb- or street-level. In this case it is possible that even with anonymised data, individuals could be identified using local knowledge. Again, this is not the case as information is provided at a national level. This means that data anonymisation techniques such as differential privacy are not only not necessary, but detrimental to the accuracy.

Considering now corporate privacy, as this data is available publicly from Spanish TSO Red Electric España, there is no concern of corporate property breach. Further to this, the body holding the data is the national government body, which will have ensured that it complies with both Spanish and European data privacy regulations.

## Security

Confidentiality, integrity, and availability are the three main factors that should be considered when ensuring the security a data project. Confidentiality is ensured through the resolution of the data being at a national scale and being collected at source thus ensuring no identifiable information is available in the first place. This data is publicly available and so there is no need to ensure that this data is kept fully secure while handling it. If there were identifiable aspects to the original data, the responsibility to ensure this information is secure lies with the body holding the information and to ensure they are compliant with any national or European data laws. The analysis, organization and modelling were completed and stored using Microsoft Teams and a Git repository, which all require, at minimum, password protection or multi-factor authentication. While the information within each storage means does not need to be protected, each service has a responsibility to protect the personal information of our team.

Integrity was maintained for this project through the upkeep of a Git repository, ensuring that we had a complete record of changes to the code and report. This way the code was kept up-to-date while allowing us to keep records of previous versions in case we needed to roll back edits to the code. We made sure we keep an unedited version of the original dataset. Access to edit files was only allowed through team members accounts which were all password protected. Even if someone obtained access to the files and made unregulated changes, these would be recorded through git, ensuring it would be simple to stay on top of our work.

Availability of data and files was ensured through utilizing cloud-based platforms for all data, codes, and reports. This ensures that all members of the team could access all files in their most up to date format provided an internet connection was present. Each update to the formats would be associated with the respective team member account and so would be authorized within the platform. All platforms are mainstream and so utilize top level protection. Should the servers go down due to something like a DDOS attack, each git repository is stored locally on devices as well, so one of us would still have the most up-to-date file.

# Exploratory Data Analysis

In the first section, [Overall statistics], we look at statistics for each source over the entire time series, and calculate correlations between sources.

In the second section, [Time series visualisation], we investigate some of these correlations, using charts to compare how different sources vary over time with respect to one another. Here we also examine interesting long-term trends and seasonality.


## Overall statistics

```{r summary stats, echo=FALSE}
# Changing the order of the variables from largest to smallest
data_table <- data %>% select(c("Nuclear", "Gas", "Wind Onshore", "Hard Coal", "Hydro Reservoir", "Solar", "Hydro River", "Lignite", "Hydro Pumped", "Biomass", "Oil", "Waste", "Other Renewable", "Other"))
# Creating CV statistic function
CV <- function(x) sd(x)/mean(x)
f <- All(data_table) ~ Mean + SD + CV + Min + Median + Max + Histogram
datasummary(f, data_table, output="markdown") # Previously output = "markdown"
```
The table above shows summary statistics for every generation source in the dataset, ordered from largest to smallest mean hourly value. This allows a quick comparison of the magnitude and variability of each source. Of the top 5 sources, two are fossil-fuel based (Gas and Hard Coal). Nuclear is a unique source in that it has the largest average hourly generation, but a relatively low standard deviation, compared to other major sources. This combination of high mean and low variability is best summarised by the coefficient of variation (CV) statistic. Nuclear has the lowest CV out of all sources. Wind Onshore has the largest variability in hourly output, followed by Gas. Solar, however, is a source with very strong seasonality, and this is shown by its higher CV than both Wind Onshore and Gas.

As discussed in the Background section, understanding interdependencies between electricity generation sources is important to maintaining energy availability in the short- and medium-term, but also to manage energy transition in the long-term. We calculated Pearson correlation coefficients as a way of investigating linear associations in the dataset. (NB: Due to the autocorrelation properties of time series data, these should be interpreted with caution, but can still give insights into associations.)

```{r correlation plot, echo=FALSE, warning=FALSE}
# Correlation plot
df_corr <- data[,2:ncol(data)]

corrmatrix <- df_corr %>% cor()
corrplot(corrmatrix, method = "color", addCoef.col="black", order = "FPC", number.cex= 0.7, tl.cex=0.5, tl.col = "black", type = 'lower', cl.pos = 'n')
```

Nuclear, the largest overall contributor to electricity generation, does not have any significant correlations (here defined as correlations with absolute value greater than 0.3). Therefore, not only is Nuclear an incredibly steady generation source, it is also one that does not obviously depend on or affect the amount of electricity produced by other sources. Solar, on the other hand, is a much more variable source, but this correlation also has no significant correlations, showing it is also a very independent generation method.

Three generation sources that are very *dependent*, or closely related to other sources, are Hard Coal, Hydro River, and Other Renewable. The largest correlation in the dataset is a positive correlation of 0.77 between Hard Coal and Lignite. Lignite is another type of coal, so it makes sense that these two sources would change in tandem. Other correlations are investigated further in the discussion of the time series plots in the next section.

## Time series visualisation

The [R Shiny dashboard](https://danielpetterson.shinyapps.io/scripts/) accompanies this section of the EDA. The dashboard allows interactive exploration of each electricity generation source over time, with customisation of which time period to look at, how much to smooth the data, and how to compare the variables. Here, we focus on the most interesting patterns.

The plot below shows the five sources with the greatest long-term change over the four-year period. There five sources also happen to have the lowest mean hourly values of the 14 studied in this dataset.
Biomass, Oil, and Other generation sources all show a rapid decrease from a high in 2015 to a low in early 2016, with monthly averages remaining around this low for the remainder of the series. On the other hand, Waste and Other renewable sources show a sustained increase from 2015 to early 2017, and monthly averages reaming around this high value for the remainder of the series. 
The similar or opposite nature of the trends between these generation sources are reflected in strong positive or negative correlations. For example, Biomass and Other sources have the strongest positive linear association of any two sources in the data, with a correlation of 0.66. Meanwhile, the opposing trends mean that Biomass and Other renewable sources have the strongest negative linear association of any two sources, with a correlation of 0.56.

Unlike with Hard Coal and Lignite, or Hydro River and Hydro Reservoir, it is not immediately obvious why these sources follow similar or opposite trends. Also, due to their low contribution to overall electricity generation, these marked long-term trends do not have a large effect on total energy output.

<center>

![**Monthly averages of Biomass, Oil, Other Renewable, Other, and Waste**](../figures/5_sources.png){width=80%}

</center>

Hard Coal and Hydro River, as shown in the correlation plot, are the two least independent generation sources - in other words, those most related to the values of other sources. The plot below shows some examples of this interdependence, by plotting the mean-centered variation over time of Hard Coal, Hydro River, and Hydro Reservoir.

```{r mean centered}
center_scale <- function(x) {
  scale(x, scale=FALSE)
}

data_centered <- data %>%
  select(c("Hard Coal", "Hydro Reservoir", "Hydro River")) %>%
  mutate_all(., center_scale) %>%
  mutate(time = data$time) %>%
  pivot_longer(cols = -time, names_to = "generation_source") %>% 
  group_by(generation_source) %>% 
  summarise_by_time(time, .by = "monthly", adjusted = mean(value))

ggplot(data_centered)+
  geom_line(aes(x=time, y=adjusted, color=generation_source))+
  geom_hline(yintercept=0, linetype="dashed")+
  labs(x="Time", y="Difference from Mean (MW)", title="Mean Centered Variation Over Time")+
  scale_color_discrete(name = "Generation\nMethod") +
  theme(plot.title = element_text(hjust = 0.5),panel.background = element_rect(fill = 'white', color = 'white')) 
```


</center>

Due to the way the peaks and troughs of each source are either in phase or 180$^\circ$ out of phase, we clearly observe a close positive correlation between the two Hydro sources (correlation = 0.65), and a negative correlation between both these sources and Hard Coal (correlation with Hydro Reservoir = -0.16, with Hydro River = -0.5). The reason behind these relationships is likely to be that a more reliable energy source such as a coal is used to generate electricity when renewable (and therefore more desired) sources such as hydro power have lower output than is needed.  

The most obvious seasonality we detected was for Solar generation. In fact, Solar displayed seasonality on two different scales. In the following plot below we can see that this variable is seasonal on a daily scale, peaking between 11am and 2pm and hitting a low at 8am and the few hours prior. This is an intuitive periodicity: a location receives the most sunlight around noon, and no sunlight during the night.

<center>

![**A subset of hourly averages of a subset of Solar**](../figures/solar_hourly.png){width=80%}

</center>

In the next plot we can see that Solar is seasonal on a monthly scale. Electricity generation by solar peaks at around 2000MW in June or July each year, and hits a low of between 800MW and 1000MW in November or December each year. Once again, this periodicity makes intuitive sense, with higher generation in the summer months and lower generation in the winter months.

<center>

![**Monthly averages of Solar**](../figures/solar_monthly.png){width=80%}

</center>

Although an early pioneer in renewable energy, changes in government policy including the reduction of financial incentives stymied the growth of renewable energy capacity in the country. This is especially true for solar power plants which have remained at a similar generation capacity between 2011 and 2017 [@GURTLER2019110881].

```{r solar daily total}
data %>%
  mutate(Year=year(time), Month=month(time), Day=day(time)) %>%
  select(c(Year, Month, Day, Solar)) %>%
  mutate(Date=as.Date(with(., paste(Year, Month, Day,sep="-")), "%Y-%m-%d")) %>%
  group_by(Date) %>%
  summarise(Solar=sum(Solar)) %>%
  ggplot(aes(x=Date, y=Solar))+
  geom_line()+
  labs(x="Date", y="Power Generated (MW)", title="Total Photovoltaic Power Generation per Day")+
  scale_colour_viridis_d() +
  theme(plot.title = element_text(hjust = 0.5),panel.background = element_rect(fill = 'white', color = 'white')) 
```

 From the above plot we can see that total daily power generated from photovoltaic solar systems shows little change across the years we investigated. The similarity of high peaks in winter and summer is likely due to almost all of the solar generation capacity in Spain being photovoltaic rather than thermal. While there are less sunlight hours in winter the amount and intensity of sun would be similar in the middle of the day, in fact in the high heats present in Spain during summer, solar panels are less efficient, however no clear evidence for this translated in to the data.
 
While other seasonal effects are less clear, by deconstructing the signal, overarching trends, variance and some degree of seasonality can be found in most of the data. Below the signal decomposition for our natural hydro sources is shown. A clear, yearly seasonal cycle is shown, likely demonstrating the existence of a wet and dry season in Spain. On top of this a repeated monthly spike and drop is seen, likely due to some form of maintenance cycle.By overlaying the smoothed seasonal variation with Solar, we can see that they are roughly antiphased. While this will help to provide a constant year round supply, the magnitude difference suggests that there will be some residual seasonal signal present in the other generation sources given the assumption of constant year round generation of electricity. This is seen in further signal decomposition and would help to explain the strong negative correlation between hydro sources and many hydrocarbon energy sources.

<center>

![**Signal Decomposition of Hydro Sources**](../figures/hydro_season.png){width=80%}

</center>


*QUESTION* 

Dont know whether to plot or bring in the below - as mentioned above - shows perfect anti phase of hydro and coal in this case seasonal component - ive actually just seen this is gone into above - brain fried deel free to remove

<center>

![**Signal Decomposition of Hydro Sources**](../figures/hydro_coal.png){width=80%}

</center>

#### Proportion of fossil fuel usage over time

*NEED TO REFERENCE PROPERLY - WILL DO IN MORNING*

*Some interp tenuous here - included to discuss tomorrow*

Overall we see a number of trends, further to the seasonality deficit, that underlay the fossil fuel usage over time. As shown below, once seasonality and variance are removed, all display a trend of decreasing to mid 2016, then increasing to mid 2017 before decreasing afterwards. While the inflection points are not identical, they are extremely similar and as such can likely be partially explained by common political factors. The first inflection point centres around June 2016, a Spanish general election with issues centering around green energy and environmental friendliness. Articles talk about the drive at the time to support renewable energy and the uncertainty in the fossil fuel sector which lead to a divsersification away from them (https://www.fitchratings.com/research/corporate-finance/limited-risk-of-energy-reforms-reversal-in-spain-political-risk-remains-24-02-2016). In early 2017 the spanish 
government implemented the energy efficiency action plan (https://ec.europa.eu/energy/sites/default/files/documents/es_neeap_2017_en.pdf) which reafferms and incentivises the use of non fossil fuel based energy, again leading to the diversification away from them and leading to a decrease in the generation from them.





<center>

![**Signal Decomposition of Hydro Sources**](../figures/fossil_trends.png){width=80%}

</center>


While the total amount of power generated from fossil fuels varies over time in response to the shortfall between renewables/nuclear and consumer demand there is a very clear relationship between the proportion of power produced from Liquid Natural Gas (LNG) and Hard Coal. The rise in LNG usage is likely driven by dropping prices and the availability of infrastructure to import it en masse as Spain is home to one third of Europe’s LNG import capacity[@lng].

```{r test}
fossil <- data %>%
  select(c(Biomass,`Hard Coal`, Lignite, Gas, Oil))

cbind(data[1], prop.table(as.matrix(fossil), margin = 1)) %>%
  pivot_longer(cols = -time, names_to = "generation_source") %>%
  group_by(generation_source) %>% 
  summarise_by_time(time, .by = '1 month', adjusted = mean(value)) %>% 
  ggplot() + 
  geom_line(aes(x = time, y = adjusted, color = generation_source), stat = "identity") +
  labs(x="Date", y="Proportion", title="Proportion of Power from Fossil Fuels by Type")+
  scale_colour_viridis_d(name = "Fuel Type") +
  theme_minimal()+
  theme(plot.title = element_text(hjust = 0.5)) 
```









# Individual contributions

*1 page, 2 marks*

*Quick bullet points before writing up*

Daniel P:

- Repo Manager 
- Built Shiny app to allow for interactive exploration of data
- wider literature review

Rob:

- timeline/project manager
- Data analysis
- Ethics, privacy and security
- wider literature review
- shiny app code review
- Team Mascot 

Daniel W:

- Document and bibliography manager
- Investigated and wrote about outliers and effect of linear interpolation
- Investigated and wrote about correlations, long-term trends and seasonality 
- Proof-read and edited Ethics, Privacy and Security section.
- wider literature review

# Conclusion
An Exploratory Data Analysis of electricity generation in Spain between 2015 and 2018 was conducted to investigate how the generation by different sources has changed over time. This dataset required cleaning of a small number of missing values and outliers, which were filled in by linear interpolation. 
We found that nuclear is the most important generation source over the period, not only due to its high mean output but also its low variability. A number of low-output sources showed significant long-term change in their average output. Seasonality was observed in solar generation (on two scales), and to a lesser extent in hydroelectric sources. The overall generation amount remained roughly constant for Spain and as such this seasonality induced echo seasonality in some of the fossil fuel sources. 
This analysis could help inform government policy around clean energy investment, and there were some concerns around ethical implications of how this research could affect future policy around climate change and affordable energy. 
